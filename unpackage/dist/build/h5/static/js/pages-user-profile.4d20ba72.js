(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-profile"],{1170:function(e,s,t){"use strict";t.r(s);var i=t("69bf"),n=t("98a7");for(var o in n)"default"!==o&&function(e){t.d(s,e,(function(){return n[e]}))}(o);t("2812");var r,a=t("f0c5"),u=Object(a["a"])(n["default"],i["b"],i["c"],!1,null,"4c4f01ff",null,!1,i["a"],r);s["default"]=u.exports},2812:function(e,s,t){"use strict";var i=t("d295"),n=t.n(i);n.a},5169:function(e,s,t){"use strict";(function(e){var i=t("ee27");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,t("96cf");var n=i(t("c964")),o=i(t("383a")),r=i(t("7e3d")),a=i(t("b9aa")),u="",p={components:{},computed:{userInfo:function(){var e=this.getStoreUserInfo();if(e.nickName)return e;var s=o.default.cache("appLoginType",null),t=o.default.cache("app_user_info_"+s,null),i=t?JSON.parse(t):{};return i},phone:function(){var e=this.userInfo;return e.phone},avatarUrl:function(){var s=this.userInfo;return e("log","u.avatarUrl",s.avatarUrl," at pages/user/profile.vue:52"),s.avatarUrl?s.avatarUrl:"../../static/img/user/people.png"},nickName:function(){var e=this.userInfo;return e.nickName}},data:function(){return{}},onLoad:function(){var s=o.default.cache("appLoginType",null),t=o.default.cache("app_user_info_"+s,null),i=t?JSON.parse(t):{};u=i.uid,e("log","uid",u,"userInfo",i," at pages/user/profile.vue:72"),this.getUserInfo()},methods:{isHasCameraPermission:function(e){return 1==e?this.requestAndroidPermission("android.permission.CAMERA"):2==e?this.judgeIosPermission("camera"):void 0},isHasPhotoPermission:function(e){if(1==e){var s=this.requestAndroidPermission("android.permission.READ_EXTERNAL_STORAGE"),t=this.requestAndroidPermission("android.permission.WRITE_EXTERNAL_STORAGE");return s&&t}if(2==e)return this.judgeIosPermission("photoLibrary")},judgeIosPermission:function(e){var s=a.default.judgeIosPermission(e);return s},requestAndroidPermission:function(e){return(0,n.default)(regeneratorRuntime.mark((function s(){var t;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a.default.requestAndroidPermission(e);case 2:return t=s.sent,s.abrupt("return",t);case 4:case"end":return s.stop()}}),s)})))()},bindPickerChange:function(s){e("log","e"," at pages/user/profile.vue:109")},getUserInfo:function(){var s=this,t=getApp().globalData,i=t.serverUri,n=t.auth,a=i+"?mod=user&ac=check_app_user";e("log","check_app_user",{auth:n,uid:u,filterData:!0}," at pages/user/profile.vue:117"),r.default.request(a,{auth:n,uid:u,filterData:!0}).then((function(t){if(e("log","resp",t," at pages/user/profile.vue:127"),1==t.status){var i=t.data,n=s.userInfo;if(i.name&&(n.nickName=i.name),i.img&&(n.avatarUrl=i.img),i.phone&&(n.phone=i.phone),i.uid&&(n.uid=i.uid),e("log","userINfo uid",n," at pages/user/profile.vue:147"),n.uid){var r=o.default.cache("appLoginType",null);s.setUserInfo(n),o.default.cache("app_user_info_"+r,JSON.stringify(n),1296e3)}}}))},setUserInfo:function(e){this.$store.commit("setUserInfo",e)},getStoreUserInfo:function(){return this.$store.getters.userInfo},switchImage:function(s){e("log","switch image!!!!"," at pages/user/profile.vue:163");var t=this,i=getApp().globalData.platform,n=this.isHasCameraPermission(i),r=this.isHasPhotoPermission(i);1!=i||n&&r?uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(s){e("log",JSON.stringify(s.tempFilePaths)," at pages/user/profile.vue:188"),e("log","res",s," at pages/user/profile.vue:190");var i=getApp().globalData,n=i.serverUri,r=i.auth,a={auth:r,uid:u};uni.uploadFile({url:n+"?mod=user&ac=img_xg",filePath:s.tempFilePaths[0],name:"file",formData:a,success:function(s){e("log",s," at pages/user/profile.vue:205");var i=s.data,n=JSON.parse(i);if(1==n.status){e("log","dataObj",n," at pages/user/profile.vue:210");var r=n.data.img;e("log","imgSec",r," at pages/user/profile.vue:212");var a=t.getStoreUserInfo();a.avatarUrl=r,e("log","uInfo",a," at pages/user/profile.vue:215"),t.setUserInfo(a);var u=o.default.cache("appLoginType",null),p=o.default.cache("app_user_info_"+u,null);if(p){var l=JSON.parse(p);l.avatarUrl=r;var c=JSON.stringify(l);o.default.cache("app_user_info_"+u,c,1296e3)}}else uni.showToast({icon:"none",title:n.message,duration:2e3})}})}}):uni.showModal({title:"提示",content:"请先开启摄像头和相册权限后,再去上传头像!",showCancel:!1,success:function(){}})},bindPhone:function(){uni.navigateTo({url:"/pages/user/bind_phone_v2"})},editNickname:function(){uni.navigateTo({url:"/pages/user/edit_nickname"})}}};s.default=p}).call(this,t("0de9")["log"])},"69bf":function(e,s,t){"use strict";var i={uniList:t("05e0").default,uniListItem:t("b22d").default},n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-uni-view",[t("v-uni-view",{attrs:{id:"list"}},[t("uni-list",[t("uni-list-item",{attrs:{title:"头像"},on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e.switchImage.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[t("v-uni-image",{attrs:{id:"image-size",src:e.avatarUrl}})]},proxy:!0}])}),t("uni-list-item",{attrs:{title:"昵称"},on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e.editNickname.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[t("v-uni-text",{staticClass:"bottom-version-text"},[e._v(e._s(e.nickName))])]},proxy:!0}])}),t("uni-list-item",{attrs:{title:"绑定手机"},on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e.bindPhone.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[t("v-uni-text",{staticClass:"bottom-version-text"},[e._v(e._s(e.phone))])]},proxy:!0}])})],1)],1)],1)},o=[];t.d(s,"b",(function(){return n})),t.d(s,"c",(function(){return o})),t.d(s,"a",(function(){return i}))},"98a7":function(e,s,t){"use strict";t.r(s);var i=t("5169"),n=t.n(i);for(var o in i)"default"!==o&&function(e){t.d(s,e,(function(){return i[e]}))}(o);s["default"]=n.a},b9aa:function(e,s,t){(function(s){var i;function n(){var e=!1,t=plus.ios.import("UIApplication"),i=t.sharedApplication(),n=0;if(i.currentUserNotificationSettings){var o=i.currentUserNotificationSettings();n=o.plusGetAttribute("types"),s("log","enabledTypes1:"+n," at components/js_sdk/wa-permission/permission.js:19"),0==n?s("log","推送权限没有开启"," at components/js_sdk/wa-permission/permission.js:21"):(e=!0,s("log","已经开启推送功能!"," at components/js_sdk/wa-permission/permission.js:24")),plus.ios.deleteObject(o)}else n=i.enabledRemoteNotificationTypes(),0==n?s("log","推送权限没有开启!"," at components/js_sdk/wa-permission/permission.js:30"):(e=!0,s("log","已经开启推送功能!"," at components/js_sdk/wa-permission/permission.js:33")),s("log","enabledTypes2:"+n," at components/js_sdk/wa-permission/permission.js:35");return plus.ios.deleteObject(i),plus.ios.deleteObject(t),e}function o(){var e=!1,t=plus.ios.import("CLLocationManager"),i=t.authorizationStatus();return e=2!=i,s("log","定位权限开启："+e," at components/js_sdk/wa-permission/permission.js:48"),plus.ios.deleteObject(t),e}function r(){var e=!1,t=plus.ios.import("AVAudioSession"),i=t.sharedInstance(),n=i.recordPermission();return s("log","permissionStatus:"+n," at components/js_sdk/wa-permission/permission.js:70"),1684369017==n||1970168948==n?s("log","麦克风权限没有开启"," at components/js_sdk/wa-permission/permission.js:72"):(e=!0,s("log","麦克风权限已经开启"," at components/js_sdk/wa-permission/permission.js:75")),plus.ios.deleteObject(t),e}function a(){var e=!1,t=plus.ios.import("AVCaptureDevice"),i=t.authorizationStatusForMediaType("vide");return s("log","authStatus:"+i," at components/js_sdk/wa-permission/permission.js:86"),3==i?(e=!0,s("log","相机权限已经开启"," at components/js_sdk/wa-permission/permission.js:89")):s("log","相机权限没有开启"," at components/js_sdk/wa-permission/permission.js:91"),plus.ios.deleteObject(t),e}function u(){var e=!1,t=plus.ios.import("PHPhotoLibrary"),i=t.authorizationStatus();return s("log","authStatus:"+i," at components/js_sdk/wa-permission/permission.js:102"),3==i?(e=!0,s("log","相册权限已经开启"," at components/js_sdk/wa-permission/permission.js:105")):s("log","相册权限没有开启"," at components/js_sdk/wa-permission/permission.js:107"),plus.ios.deleteObject(t),e}function p(){var e=!1,t=plus.ios.import("CNContactStore"),i=t.authorizationStatusForEntityType(0);return 3==i?(e=!0,s("log","通讯录权限已经开启"," at components/js_sdk/wa-permission/permission.js:120")):s("log","通讯录权限没有开启"," at components/js_sdk/wa-permission/permission.js:122"),plus.ios.deleteObject(t),e}function l(){var e=!1,t=plus.ios.import("EKEventStore"),i=t.authorizationStatusForEntityType(0);return 3==i?(e=!0,s("log","日历权限已经开启"," at components/js_sdk/wa-permission/permission.js:135")):s("log","日历权限没有开启"," at components/js_sdk/wa-permission/permission.js:137"),plus.ios.deleteObject(t),e}function c(){var e=!1,t=plus.ios.import("EKEventStore"),i=t.authorizationStatusForEntityType(1);return 3==i?(e=!0,s("log","备忘录权限已经开启"," at components/js_sdk/wa-permission/permission.js:150")):s("log","备忘录权限没有开启"," at components/js_sdk/wa-permission/permission.js:152"),plus.ios.deleteObject(t),e}function d(e){return new Promise((function(t,i){plus.android.requestPermissions([e],(function(e){for(var i=0,n=0;n<e.granted.length;n++){var o=e.granted[n];s("log","已获取的权限："+o," at components/js_sdk/wa-permission/permission.js:167"),i=1}for(n=0;n<e.deniedPresent.length;n++){var r=e.deniedPresent[n];s("log","拒绝本次申请的权限："+r," at components/js_sdk/wa-permission/permission.js:172"),i=0}for(n=0;n<e.deniedAlways.length;n++){var a=e.deniedAlways[n];s("log","永久拒绝申请的权限："+a," at components/js_sdk/wa-permission/permission.js:177"),i=-1}t(i)}),(function(e){s("log","申请权限错误："+e.code+" = "+e.message," at components/js_sdk/wa-permission/permission.js:187"),t({code:e.code,message:e.message})}))}))}function f(e){return"location"==e?o():"camera"==e?a():"photoLibrary"==e?u():"record"==e?r():"push"==e?n():"contact"==e?p():"calendar"==e?l():"memo"==e&&c()}function m(){if(i){var e=plus.ios.import("UIApplication"),s=e.sharedApplication(),t=plus.ios.import("NSURL"),n=t.URLWithString("app-settings:");s.openURL(n),plus.ios.deleteObject(n),plus.ios.deleteObject(t),plus.ios.deleteObject(s)}else{var o=plus.android.importClass("android.content.Intent"),r=plus.android.importClass("android.provider.Settings"),a=plus.android.importClass("android.net.Uri"),u=plus.android.runtimeMainActivity(),p=new o;p.setAction(r.ACTION_APPLICATION_DETAILS_SETTINGS);var l=a.fromParts("package",u.getPackageName(),null);p.setData(l),u.startActivity(p)}}function g(){if(i){var e=!1,t=plus.ios.import("CLLocationManager");e=t.locationServicesEnabled();return s("log","系统定位开启:"+e," at components/js_sdk/wa-permission/permission.js:253"),plus.ios.deleteObject(t),e}var n=plus.android.importClass("android.content.Context"),o=plus.android.importClass("android.location.LocationManager"),r=plus.android.runtimeMainActivity(),a=r.getSystemService(n.LOCATION_SERVICE);e=a.isProviderEnabled(o.GPS_PROVIDER);return s("log","系统定位开启:"+e," at components/js_sdk/wa-permission/permission.js:262"),e}t("d3b7"),e.exports={judgeIosPermission:f,requestAndroidPermission:d,checkSystemEnableLocation:g,gotoAppPermissionSetting:m}}).call(this,t("0de9")["log"])},d295:function(e,s,t){var i=t("e240");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=t("4f06").default;n("fdc29b14",i,!0,{sourceMap:!1,shadowMode:!1})},e240:function(e,s,t){var i=t("24fb");s=i(!1),s.push([e.i,"uni-page-body[data-v-4c4f01ff]{background:#f3f3f3}#list[data-v-4c4f01ff]{margin-top:%?58?%;margin-left:%?30?%;margin-right:%?30?%;width:%?690?%;background:#fff;border-radius:%?20?%}[data-v-4c4f01ff] .uni-list-item__content-title{font-size:%?28?%!important;font-family:PingFang SC!important;font-weight:500!important;color:#333!important;line-height:%?120?%;height:%?120?%!important}[data-v-4c4f01ff] .uni-list-item__extra{margin-right:%?37?%}#image-size[data-v-4c4f01ff]{width:%?64?%;height:%?64?%;border-radius:50%;margin-right:%?34?%}.bottom-version-text[data-v-4c4f01ff]{margin-right:%?34?%;font-size:%?28?%;font-family:PingFang SC;font-weight:500;color:#999}body.?%PAGE?%[data-v-4c4f01ff]{background:#f3f3f3}",""]),e.exports=s}}]);