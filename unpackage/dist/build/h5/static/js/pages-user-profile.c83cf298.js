(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-profile"],{1170:function(e,t,s){"use strict";s.r(t);var i=s("a0f5"),n=s("98a7");for(var o in n)"default"!==o&&function(e){s.d(t,e,(function(){return n[e]}))}(o);s("7c25");var r,a=s("f0c5"),u=Object(a["a"])(n["default"],i["b"],i["c"],!1,null,"78c5ea2c",null,!1,i["a"],r);t["default"]=u.exports},5169:function(e,t,s){"use strict";(function(e){var i=s("ee27");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,s("96cf");var n=i(s("c964")),o=i(s("383a")),r=i(s("7e3d")),a=i(s("b9aa")),u="",p={components:{},computed:{userInfo:function(){var e=this.getStoreUserInfo();if(e.nickName)return e;var t=o.default.cache("appLoginType",null),s=o.default.cache("app_user_info_"+t,null),i=s?JSON.parse(s):{};return i},phone:function(){var e=this.userInfo;return e.phone},avatarUrl:function(){var t=this.userInfo;return e("log","u.avatarUrl",t.avatarUrl," at pages/user/profile.vue:60"),t.avatarUrl?t.avatarUrl:"../../static/img/user/people.png"},nickName:function(){var e=this.userInfo;return e.nickName}},data:function(){return{bottom:""}},onLoad:function(){var t=o.default.cache("appLoginType",null),s=o.default.cache("app_user_info_"+t,null),i=s?JSON.parse(s):{};u=i.uid,e("log","uid",u,"userInfo",i," at pages/user/profile.vue:81");var n=uni.getSystemInfoSync();this.bottom=n.windowHeight-60,this.getUserInfo()},methods:{isHasCameraPermission:function(e){return 1==e?this.requestAndroidPermission("android.permission.CAMERA"):2==e?this.judgeIosPermission("camera"):void 0},isHasPhotoPermission:function(e){if(1==e){var t=this.requestAndroidPermission("android.permission.READ_EXTERNAL_STORAGE"),s=this.requestAndroidPermission("android.permission.WRITE_EXTERNAL_STORAGE");return t&&s}if(2==e)return this.judgeIosPermission("photoLibrary")},judgeIosPermission:function(e){var t=a.default.judgeIosPermission(e);return t},requestAndroidPermission:function(e){return(0,n.default)(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.default.requestAndroidPermission(e);case 2:return s=t.sent,t.abrupt("return",s);case 4:case"end":return t.stop()}}),t)})))()},bindPickerChange:function(t){e("log","e"," at pages/user/profile.vue:120")},getUserInfo:function(){var t=this,s=getApp().globalData,i=s.serverUri,n=s.auth,a=i+"?mod=user&ac=check_app_user";e("log","check_app_user",{auth:n,uid:u,filterData:!0}," at pages/user/profile.vue:128"),r.default.request(a,{auth:n,uid:u,filterData:!0}).then((function(s){if(e("log","resp",s," at pages/user/profile.vue:138"),1==s.status){var i=s.data,n=t.userInfo;if(i.name&&(n.nickName=i.name),i.img&&(n.avatarUrl=i.img),i.phone&&(n.phone=i.phone),i.uid&&(n.uid=i.uid),e("log","userINfo uid",n," at pages/user/profile.vue:158"),n.uid){var r=o.default.cache("appLoginType",null);t.setUserInfo(n),o.default.cache("app_user_info_"+r,JSON.stringify(n),1296e3)}}}))},setUserInfo:function(e){this.$store.commit("setUserInfo",e)},getStoreUserInfo:function(){return this.$store.getters.userInfo},switchImage:function(t){e("log","switch image!!!!"," at pages/user/profile.vue:174");var s=this,i=getApp().globalData.platform,n=this.isHasCameraPermission(i),r=this.isHasPhotoPermission(i);1!=i||n&&r?uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){e("log",JSON.stringify(t.tempFilePaths)," at pages/user/profile.vue:199"),e("log","res",t," at pages/user/profile.vue:201");var i=getApp().globalData,n=i.serverUri,r=i.auth,a={auth:r,uid:u};uni.uploadFile({url:n+"?mod=user&ac=img_xg",filePath:t.tempFilePaths[0],name:"file",formData:a,success:function(t){e("log",t," at pages/user/profile.vue:216");var i=t.data,n=JSON.parse(i);if(1==n.status){e("log","dataObj",n," at pages/user/profile.vue:221");var r=n.data.img;e("log","imgSec",r," at pages/user/profile.vue:223");var a=s.getStoreUserInfo();a.avatarUrl=r,e("log","uInfo",a," at pages/user/profile.vue:226"),s.setUserInfo(a);var u=o.default.cache("appLoginType",null),p=o.default.cache("app_user_info_"+u,null);if(p){var c=JSON.parse(p);c.avatarUrl=r;var l=JSON.stringify(c);o.default.cache("app_user_info_"+u,l,1296e3)}}else uni.showToast({icon:"none",title:n.message,duration:2e3})}})}}):uni.showModal({title:"提示",content:"请先开启摄像头和相册权限后,再去上传头像!",showCancel:!1,success:function(){}})},bindPhone:function(){uni.navigateTo({url:"/pages/user/bind_phone_v2"})},editNickname:function(){uni.navigateTo({url:"/pages/user/edit_nickname"})}}};t.default=p}).call(this,s("0de9")["log"])},"7c25":function(e,t,s){"use strict";var i=s("98d1"),n=s.n(i);n.a},"98a7":function(e,t,s){"use strict";s.r(t);var i=s("5169"),n=s.n(i);for(var o in i)"default"!==o&&function(e){s.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},"98d1":function(e,t,s){var i=s("d8e2");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=s("4f06").default;n("472205f2",i,!0,{sourceMap:!1,shadowMode:!1})},a0f5:function(e,t,s){"use strict";var i={uniList:s("05e0").default,uniListItem:s("b22d").default},n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-uni-view",[s("v-uni-view",{attrs:{id:"list"}},[s("uni-list",[s("uni-list-item",{attrs:{title:"头像",isBottomEvery:"1"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.switchImage.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[s("v-uni-image",{attrs:{id:"image-size",src:e.avatarUrl}})]},proxy:!0}])}),s("uni-list-item",{attrs:{title:"昵称",isBottomEvery:"1"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.editNickname.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[s("v-uni-text",{staticClass:"bottom-version-text"},[e._v(e._s(e.nickName))])]},proxy:!0}])}),s("uni-list-item",{attrs:{title:"绑定手机",isBottomEvery:"1"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.bindPhone.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[s("v-uni-text",{staticClass:"bottom-version-text"},[e._v(e._s(e.phone))])]},proxy:!0}])})],1)],1),s("v-uni-view",{style:{top:e.bottom+"px"},attrs:{id:"bottom-view"}},[s("v-uni-view",{staticClass:"login-info-text"},[s("v-uni-navigator",{staticClass:"underline-text",attrs:{url:"/pages/user/user_agreement",tap:"gotoUserAllowPage"}},[e._v("《用户许可》")]),s("v-uni-text",[e._v("和")]),s("v-uni-navigator",{staticClass:"underline-text",attrs:{url:"/pages/user/software_license",tap:"gotoUserLicensePage"}},[e._v("《隐私协议》")])],1)],1)],1)},o=[];s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return i}))},b9aa:function(e,t,s){(function(t){var i;function n(){var e=!1,s=plus.ios.import("UIApplication"),i=s.sharedApplication(),n=0;if(i.currentUserNotificationSettings){var o=i.currentUserNotificationSettings();n=o.plusGetAttribute("types"),t("log","enabledTypes1:"+n," at components/js_sdk/wa-permission/permission.js:19"),0==n?t("log","推送权限没有开启"," at components/js_sdk/wa-permission/permission.js:21"):(e=!0,t("log","已经开启推送功能!"," at components/js_sdk/wa-permission/permission.js:24")),plus.ios.deleteObject(o)}else n=i.enabledRemoteNotificationTypes(),0==n?t("log","推送权限没有开启!"," at components/js_sdk/wa-permission/permission.js:30"):(e=!0,t("log","已经开启推送功能!"," at components/js_sdk/wa-permission/permission.js:33")),t("log","enabledTypes2:"+n," at components/js_sdk/wa-permission/permission.js:35");return plus.ios.deleteObject(i),plus.ios.deleteObject(s),e}function o(){var e=!1,s=plus.ios.import("CLLocationManager"),i=s.authorizationStatus();return e=2!=i,t("log","定位权限开启："+e," at components/js_sdk/wa-permission/permission.js:48"),plus.ios.deleteObject(s),e}function r(){var e=!1,s=plus.ios.import("AVAudioSession"),i=s.sharedInstance(),n=i.recordPermission();return t("log","permissionStatus:"+n," at components/js_sdk/wa-permission/permission.js:70"),1684369017==n||1970168948==n?t("log","麦克风权限没有开启"," at components/js_sdk/wa-permission/permission.js:72"):(e=!0,t("log","麦克风权限已经开启"," at components/js_sdk/wa-permission/permission.js:75")),plus.ios.deleteObject(s),e}function a(){var e=!1,s=plus.ios.import("AVCaptureDevice"),i=s.authorizationStatusForMediaType("vide");return t("log","authStatus:"+i," at components/js_sdk/wa-permission/permission.js:86"),3==i?(e=!0,t("log","相机权限已经开启"," at components/js_sdk/wa-permission/permission.js:89")):t("log","相机权限没有开启"," at components/js_sdk/wa-permission/permission.js:91"),plus.ios.deleteObject(s),e}function u(){var e=!1,s=plus.ios.import("PHPhotoLibrary"),i=s.authorizationStatus();return t("log","authStatus:"+i," at components/js_sdk/wa-permission/permission.js:102"),3==i?(e=!0,t("log","相册权限已经开启"," at components/js_sdk/wa-permission/permission.js:105")):t("log","相册权限没有开启"," at components/js_sdk/wa-permission/permission.js:107"),plus.ios.deleteObject(s),e}function p(){var e=!1,s=plus.ios.import("CNContactStore"),i=s.authorizationStatusForEntityType(0);return 3==i?(e=!0,t("log","通讯录权限已经开启"," at components/js_sdk/wa-permission/permission.js:120")):t("log","通讯录权限没有开启"," at components/js_sdk/wa-permission/permission.js:122"),plus.ios.deleteObject(s),e}function c(){var e=!1,s=plus.ios.import("EKEventStore"),i=s.authorizationStatusForEntityType(0);return 3==i?(e=!0,t("log","日历权限已经开启"," at components/js_sdk/wa-permission/permission.js:135")):t("log","日历权限没有开启"," at components/js_sdk/wa-permission/permission.js:137"),plus.ios.deleteObject(s),e}function l(){var e=!1,s=plus.ios.import("EKEventStore"),i=s.authorizationStatusForEntityType(1);return 3==i?(e=!0,t("log","备忘录权限已经开启"," at components/js_sdk/wa-permission/permission.js:150")):t("log","备忘录权限没有开启"," at components/js_sdk/wa-permission/permission.js:152"),plus.ios.deleteObject(s),e}function d(e){return new Promise((function(s,i){plus.android.requestPermissions([e],(function(e){for(var i=0,n=0;n<e.granted.length;n++){var o=e.granted[n];t("log","已获取的权限："+o," at components/js_sdk/wa-permission/permission.js:167"),i=1}for(n=0;n<e.deniedPresent.length;n++){var r=e.deniedPresent[n];t("log","拒绝本次申请的权限："+r," at components/js_sdk/wa-permission/permission.js:172"),i=0}for(n=0;n<e.deniedAlways.length;n++){var a=e.deniedAlways[n];t("log","永久拒绝申请的权限："+a," at components/js_sdk/wa-permission/permission.js:177"),i=-1}s(i)}),(function(e){t("log","申请权限错误："+e.code+" = "+e.message," at components/js_sdk/wa-permission/permission.js:187"),s({code:e.code,message:e.message})}))}))}function m(e){return"location"==e?o():"camera"==e?a():"photoLibrary"==e?u():"record"==e?r():"push"==e?n():"contact"==e?p():"calendar"==e?c():"memo"==e&&l()}function f(){if(i){var e=plus.ios.import("UIApplication"),t=e.sharedApplication(),s=plus.ios.import("NSURL"),n=s.URLWithString("app-settings:");t.openURL(n),plus.ios.deleteObject(n),plus.ios.deleteObject(s),plus.ios.deleteObject(t)}else{var o=plus.android.importClass("android.content.Intent"),r=plus.android.importClass("android.provider.Settings"),a=plus.android.importClass("android.net.Uri"),u=plus.android.runtimeMainActivity(),p=new o;p.setAction(r.ACTION_APPLICATION_DETAILS_SETTINGS);var c=a.fromParts("package",u.getPackageName(),null);p.setData(c),u.startActivity(p)}}function g(){if(i){var e=!1,s=plus.ios.import("CLLocationManager");e=s.locationServicesEnabled();return t("log","系统定位开启:"+e," at components/js_sdk/wa-permission/permission.js:253"),plus.ios.deleteObject(s),e}var n=plus.android.importClass("android.content.Context"),o=plus.android.importClass("android.location.LocationManager"),r=plus.android.runtimeMainActivity(),a=r.getSystemService(n.LOCATION_SERVICE);e=a.isProviderEnabled(o.GPS_PROVIDER);return t("log","系统定位开启:"+e," at components/js_sdk/wa-permission/permission.js:262"),e}s("d3b7"),e.exports={judgeIosPermission:m,requestAndroidPermission:d,checkSystemEnableLocation:g,gotoAppPermissionSetting:f}}).call(this,s("0de9")["log"])},d8e2:function(e,t,s){var i=s("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-78c5ea2c]{background-color:#f2f2f2}#list[data-v-78c5ea2c]{margin-top:%?58?%;margin-left:%?30?%;margin-right:%?30?%;width:%?690?%;background:#fff;border-radius:%?20?%}.uni-list-item[data-v-78c5ea2c]:last-child{margin-bottom:5px}[data-v-78c5ea2c] .uni-list-item__content-title{font-size:%?28?%!important;font-family:PingFang SC!important;font-weight:500!important;color:#333!important;line-height:%?120?%;height:%?120?%!important}[data-v-78c5ea2c] .uni-list-item__extra{margin-right:%?37?%}#image-size[data-v-78c5ea2c]{width:%?64?%;height:%?64?%;border-radius:50%;margin-right:%?34?%}.bottom-version-text[data-v-78c5ea2c]{margin-right:%?34?%;font-size:%?28?%;font-family:PingFang SC;font-weight:500;color:#999}#bottom-view[data-v-78c5ea2c]{margin-left:%?30?%;margin-right:%?30?%;display:-webkit-box;display:-webkit-flex;display:flex;width:%?690?%;box-sizing:border-box;padding:%?20?%;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;position:absolute;font-size:%?24?%;font-family:PingFang SC;font-weight:400;color:#9a9a9a}#bottom-view .login-info-text[data-v-78c5ea2c]{display:-webkit-box;display:-webkit-flex;display:flex;white-space:nowrap}.underline-text[data-v-78c5ea2c]{color:#000;text-decoration:underline}body.?%PAGE?%[data-v-78c5ea2c]{background-color:#f2f2f2}',""]),e.exports=t}}]);