(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/index"],{"08b6":function(e,n,o){"use strict";var t=o("acb0"),i=o.n(t);i.a},"179c":function(e,n,o){"use strict";(function(e){o("1fff");t(o("66fd"));var n=t(o("db90"));function t(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,o("543d")["createPage"])},"49d4":function(e,n,o){"use strict";var t={uniList:function(){return o.e("components/uni-list/uni-list").then(o.bind(null,"967a"))},uniListItem:function(){return o.e("components/uni-list-item/uni-list-item").then(o.bind(null,"fbe4"))},uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"7c56"))}},i=function(){var e=this,n=e.$createElement;e._self._c},u=[];o.d(n,"b",(function(){return i})),o.d(n,"c",(function(){return u})),o.d(n,"a",(function(){return t}))},"4be0":function(e,n,o){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=u(o("edc3")),i=u(o("efb5"));function u(e){return e&&e.__esModule?e:{default:e}}var r,s=function(){o.e("common/vipinfo/vipinfo").then(function(){return resolve(o("2c19"))}.bind(null,o)).catch(o.oe)},a=function(){o.e("components/uni-popup/uni-popup-message").then(function(){return resolve(o("7a2a"))}.bind(null,o)).catch(o.oe)},c=function(){o.e("components/uni-popup/uni-popup-dialog").then(function(){return resolve(o("8ce8"))}.bind(null,o)).catch(o.oe)},l=function(){o.e("components/uni-popup/uni-popup-share").then(function(){return resolve(o("7419"))}.bind(null,o)).catch(o.oe)},f={data:function(){var e=this;return{contentHeight:0,platform:0,isIphoneX:!1,providerList:[],isShow:!0,bottomHeight:"",marginTop:"",phoneStr:"",bottomData:[{label:"微信朋友圈",icon:"/static/img/user/wx_timeline.png",onClick:function(){console.log("wx timeline click22222!"),e.shareWxOrWxTimeline("wx_timeline","weixin")}},{label:"微信",icon:"/static/img/user/wx.png",onClick:function(){console.log("wx  click!22222"),e.shareWxOrWxTimeline("wx","weixin")}}]}},components:{vipInfo:s,uniPopupDialog:c,uniPopupMessage:a,uniPopupShare:l},onShow:function(){if(1==this.platform){var e=getApp().globalData;1==e.isRecharge&&(console.log("loginRequest...."),this.loginRequest(!0))}},onShareAppMessage:function(){var e=getCurrentPages(),n=e[e.length-1],o=n.route;return{title:"个人中心",path:o,success:function(){},fail:function(){}}},onLoad:function(n){this.getUserIsAuth();var o=e.getSystemInfoSync(),t=o.windowHeight,u=o.windowWidth;console.log("winHeight",t);var r=750/u;r=r.toFixed(2),console.log("radix",r);var s=getApp().globalData;this.isIphoneX=s.isIphoneX,this.platform=s.platform,console.log("platform",this.platform),this.contentHeight=t-50,console.log(t,this.contentHeight),console.log("onLoad....",r*t),this.bottomHeight=r*t-50*r-330,this.marginTop=77*r;var a=i.default.getUserInfoFromStorage();console.log("userInfo",a),a.uid&&this.login(!1)},created:function(){e.showShareMenu({withShareTicket:!0}),console.log("created....")},computed:{userInfo:function(){var e=this.$store.getters.userInfo;if(console.log("u",e),e.nickName)return e;var n=i.default.getUserInfoFromStorage();return console.log("userInfo",n),n||{}},level:function(){var e=this.userInfo;return console.log("level-info",e),e&&e.level&&e.level?e.level:0},dates:function(){var e=this.userInfo;if(!e)return"";var n="";return e.start_time&&(n+=e.start_time+"~"),e.end_time&&(n+=e.end_time),console.log("dateStr",n),n}},methods:{showPhoneNumberModal:function(e){console.log("showPhoneNumberModal e");var n=i.default.getUserInfoFromStorage();n&&this.$refs.popupDialog.open()},getUserBindPhone:function(e){var n=this,o=getApp().globalData,i=o.serverUri,u=o.auth,s=i+"?mod=user&ac=getphone";t.default.request(s,{uid:e,auth:u,filterData:!0}).then((function(e){console.log("resp",e),n.phoneStr=e.phone,r||e.phone||_this.$refs.popupDialog.open()}))},bindPhoneNumber:function(n){var o=this;console.log("getPhoneNumber",n);var u=getApp().globalData,r=u.serverUri,s=u.auth,a=r+"?mod=user&ac=phone",c=i.default.cache("wx_userid",null);console.log("getPhoneNumber uid",c,a);var l="";l="wx",t.default.request(a,{encryptedData:n.encryptedData,iv:n.iv,uid:c,auth:s,bind_type:l,filterData:!0}).then((function(n){console.log("bind resp:",n),1==n.status&&(o.phoneStr=n.phone,e.showToast({title:"绑定成功!"}))}))},getUserIsAuth:function(){console.log("getUserIsAuth"),e.getSetting({success:function(e){console.log("res",e),r=!!e.authSetting["scope.userInfo"],console.log("isAuth",r)}})},confirm:function(e){this.$refs.popupDialog.close("center"),console.log("confirm e",e)},close:function(e){console.log("close e",e),this.$refs.popupDialog.close("center")},about_us_article:function(){e.navigateTo({url:"/pages/user/about_us"})},personal_info:function(){e.navigateTo({url:"/pages/user/complaint"})},handleComplaint:function(){e.navigateTo({url:"/pages/user/complaint"})},upgrade_vip:function(){e.navigateTo({url:"/pages/user/upgrade_user_vip"})},copy_customer_wechat:function(){var n="";e.setClipboardData({data:n,success:function(n){e.getClipboardData({success:function(n){e.showToast({title:"复制成功"})}})}})},copy_customer_qq:function(){var n="3342315151";e.setClipboardData({data:n,success:function(n){e.getClipboardData({success:function(n){e.showToast({title:"复制成功"})}})}})},setUserInfo:function(e){this.$store.commit("setUserInfo",e)},login:function(n){n||e.showLoading({title:"登录中..."}),this.loginRequest(n)},loginRequest:function(n){var o=this,t="";t="weixin",e.login({provider:t,success:function(u){var r=u.code;n||e.hideLoading();var s=getApp().globalData,a=s.serverUri,c=s.auth,l=a+"?mod=user&ac=wx_user";e.getUserInfo({provider:t,success:function(t){console.log("get UserInfo res:",t);var u=t.userInfo,a={code:r,auth:c,nickname:u.nickName,avatarurl:u.avatarUrl,city:u.city,country:u.country,gender:u.gender,province:u.province,logintype:"wx"};console.log("userData",a),e.request({url:l,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:a,success:function(e){if(console.log(e),e=e.data.data,console.log("resp",e),e){var t=e.id;u.uid=t,u.level=e.cid,e.start_time&&(u.start_time=e.start_time),e.end_time&&(u.end_time=e.end_time),e.openid&&(u.openid=e.openid),o.setUserInfo(u);new Date;var r=1296e3,a=JSON.stringify(u);i.default.cache("wx_userinfo",a,r),i.default.cache("wx_userid",u.uid),o.getUserBindPhone(u.uid),n&&(s.isRecharge=0)}}})},fail:function(){console.log("未授权")}})}})},dialogConfirm:function(e){"function"==typeof e&&e()},dialogClose:function(e){"function"==typeof e&&e()},wxGetUserInfo:function(n){console.log("get_user_info"),r||n.detail.userInfo?this.login():e.showModal({title:"警告",content:"您点击了拒绝授权，将无法进入小程序，请授权之后再进入!!!",showCancel:!1,confirmText:"返回授权",success:function(e){e.confirm&&console.log("用户点击了“返回授权”")}})}}};n.default=f}).call(this,o("543d")["default"])},"969a":function(e,n,o){"use strict";o.r(n);var t=o("4be0"),i=o.n(t);for(var u in t)"default"!==u&&function(e){o.d(n,e,(function(){return t[e]}))}(u);n["default"]=i.a},acb0:function(e,n,o){},db90:function(e,n,o){"use strict";o.r(n);var t=o("49d4"),i=o("969a");for(var u in i)"default"!==u&&function(e){o.d(n,e,(function(){return i[e]}))}(u);o("08b6");var r,s=o("f0c5"),a=Object(s["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],r);n["default"]=a.exports}},[["179c","common/runtime","common/vendor"]]]);